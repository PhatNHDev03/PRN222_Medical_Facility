@page
@model MedicaiFacility.RazorPage.Pages.HealthArticles.IndexModel


<h3>MEDICAL SYSTEM </h3>

<div class="container">
    <div class="row">
        <!-- Khu vực bài viết (70%) -->
        <div class="col-md-12">
            @if (Model.HealthArticles.Count > 0)
            {
                var random = new Random();
                var featuredArticle = Model.HealthArticles.OrderBy(x => random.Next()).FirstOrDefault();
                var otherArticles = Model.HealthArticles.Where(a => a.ArticleID != featuredArticle.ArticleID)
                .OrderBy(x => random.Next())
                .ToList();

                <div class="card mb-4 shadow-sm">
                    <div class="card-body">
                        <h3 class="card-title">@featuredArticle.Title</h3>
                        <p class="card-text">@featuredArticle.Content</p>
                        <p class="small text-muted">By @featuredArticle.AuthorName - @featuredArticle.CreatedAt</p>
                        <a href="#" class="btn btn-primary">Read More</a>
                    </div>
                </div>

                <button class="btn btn-warning mb-3" onclick="refreshArticles()">Next Article</button>

                <div class="row" id="articleContainer">
                    @foreach (var article in otherArticles)
                    {
                        <div class="col-md-6 mb-3 article-item">
                            <div class="card shadow-sm">
                                <div class="card-body">
                                    <h5 class="card-title">@article.Title</h5>
                                    <p class="small text-muted">By @article.AuthorName - @article.CreatedAt</p>
                                    <a href="#" class="btn btn-sm btn-primary">Read more</a>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <div class="text-center mt-5">
                    <i class="bi bi-exclamation-circle text-secondary" style="font-size: 3rem;"></i>
                    <h3 class="text-muted mt-3">There are no health articles available.</h3>
                    <p class="text-muted">Try creating a new one!</p>
                    <div class="mt-4">
                        <a asp-page="/HealthArticles/Create" class="btn btn-success me-2">
                            <i class="bi bi-plus-circle"></i> Create New Article
                        </a>
                        <a asp-page="/Index" class="btn btn-outline-secondary">
                            <i class="bi bi-house-door"></i> Back to Home
                        </a>
                    </div>
                </div>
            }
        </div>
        <ul class="list-group">

        </ul>


    </div>
</div>

<script>
    function refreshArticles() {
        let container = document.getElementById("articleContainer");
        let articles = Array.from(container.getElementsByClassName("article-item"));
        articles.sort(() => Math.random() - 0.5);
        container.innerHTML = "";
        articles.forEach(article => container.appendChild(article));
    }
</script>
